"use strict";(function(a){var f,c,e,d,b;c=function(d){var b,j,e,g,h,f=function(a){return a.replace(/^\/+|\/+$/g,"")},k=function(a){return a.replace(/\/+$/g,"")},i=typeof String.trim==="function"?String.trim:jQuery.trim;e={count:false,links:null,resource:null,root:null,value:false,options:{callback:null,expand:null,filter:null,inlinecount:false,orderby:null,params:null,select:null,skip:null,skiptoken:null,top:null}};if(d!==undefined)if(a.isPlainObject(d))if(d.segments===undefined)a.extend(true,e,d);else a.extend(true,e,d.segments);else typeof d==="string"&&a.extend(true,e,{root:d});j=null;h=function(i,e){var b,d,f,h,g,a;e=e||this.segments.root;b=c();a=i.split("?");if(a.length>2)throw{name:"invalid input",message:"input string is not valid, to many ? in the string"};h=a[1];b.segments.root=e;d=a[0].toUpperCase();e=e.toUpperCase();if(d.indexOf(e)===0)f=a[0].slice(e.length);else if((g=d.indexOf(e))>0)f=a[0].slice(e.length+g);else{g=0;do{e=e.slice(1);g+=1}while(e.length>0&&d.indexOf(e)!==0);f=a[0].slice(e.length)}a=f.split("/$value");b.segments.value=a.length===2;f=a[0];a=f.split("/$count");b.segments.count=a.length===2;f=a[0];if(!b.segments.value&&(a=f.split("/$links/")).length===2){b.segments.resource=a[0];b.segments.links=a[1]}else b.segments.resource=f;if(h!==undefined&&h.length>0){a=h.split("&");for(g=0;g<a.length;g+=1)a[g]=a[g].split("=");while(a.length>0){d=a.pop();switch(d[0]){case"$orderby":b.segments.options.orderby=d[1];break;case"$top":b.segments.options.top=d[1];break;case"$skip":b.segments.options.skip=d[1];break;case"$filter":b.segments.options.filter=d[1];break;case"$expand":b.segments.options.expand=d[1];break;case"$select":b.segments.options.select=d[1];break;case"$skiptoken":b.segments.options.skiptoken=d[1];break;case"$inlinecount":b.segments.options.inlinecount=d[1]==="allpages";break;case"$format":b.segments.options.format=d[1];break;default:if(b.segments.options.params===null)b.segments.options.params={};b.segments.options.params[d[0]]=d[1]}}}return b};g=function(e){var d,a,b,g=false,h,c="";e=e||this;a=e.segments;d=a.options;if(a.root===null)return"";h=a.resource!==null?f(i(a.resource)):"";if(a.links!==null)h+="/$links/"+f(a.links);if(a.count)h+="/$count";else if(a.value)h+="/$value";for(b in d)if(b!==undefined&&d[b]!==null)switch(b){case"params":for(b in d.params)if(b!==undefined){if(g)c+="&";c+=b+"="+d.params[b];g=true}break;case"inlinecount":if(d.inlinecount){if(g)c+="&";c+="$inlinecount=allpages";g=true;break}break;case"format":if(d[b]==="json"&&(a.count||a.value))break;case"callback":case"orderby":case"top":case"skip":case"filter":case"expand":case"select":case"skiptoken":if(g)c+="&";c+="$"+b+"="+d[b];g=true}e.uri=k(i(a.root));e.uri+=h!==""?"/"+h:"";e.uri+=c!==""?"?"+c:"";return e.uri};b={};b.segments=e;b.parse=h;b.uri=j;b.toString=b.toLocaleString=g;b.isLocalService=b.segments.root!==null&&(!/^http:\/\/|https:\/\//i.test(b.segments.root)||b.segments.root.toLowerCase().indexOf(location.protocol+"//"+location.host)===0);return b};f=function(g,f){var d;d={};d.settings=f||{};d.uri=c(g);if(d.settings.dataType!==undefined&&d.settings.dataType==="jsonp"){d.uri.segments.options.format="json";d.uri.segments.options.callback="resultCallback"}d.from=function(b){return e.apply(a.extend({},this),[b])};d.query=function(c){if(a.isFunction(c))c={success:c};b(this,c)};d.create=function(e,f,c){var d;if(a.isFunction(c))c={success:c};c.type="POST";c.data=JSON.stringify(f);d=a.extend(true,{},this);d.uri.segments.resource=e;b(d,c)};d.update=function(g,e,d){var f,c,h={partial:true,force:false,etag:null};if(a.isFunction(d))d={complete:d};if(d.etag===undefined&&e.__metadata!==undefined&&e.__metadata.etag!==undefined)d.etag=e.__metadata.etag;c=a.extend({},h,d);c.type=c.partial?"MERGE":"PUT";if(a.isPlainObject(e)){c.data=JSON.stringify(e);c.contentType="application/json"}else{c.data=e.toString();c.contentType="text/plain"}f=a.extend(true,{},this);f.uri.segments.resource=g;b(f,c)};d["delete"]=d.deleteEntry=d.remove=function(c,e){var d,f,g={force:false,etag:null};if(a.isFunction(e))e={complete:e};if(e.etag===undefined&&c.__metadata!==undefined&&c.__metadata.etag!==undefined)e.etag=c.__metadata.etag;f=a.extend({},g,e);if(f.force)f.etag="*";f.type="DELETE";d=a.extend(true,{},this);if(a.isPlainObject(c))if(c.__metadata!==undefined&&c.__metadata.uri!==undefined)d.uri=d.uri.parse(c.__metadata.uri);else d.uri=c;else if(typeof c==="string")d.uri=d.uri.parse(c);b(d,f)};return d};e=function(n){var b=this,k,i,j,g,d,m,l,f,e,h,c;j=function(c){var b;b=a.extend(true,{},this);b.uri.segments.links=c;return b};d=function(c){var b;b=a.extend(true,{},this);b.uri.segments.options.orderby=c;return b};m=function(c){var b;b=a.extend(true,{},this);b.uri.segments.options.top=c;return b};l=function(c){var b;b=a.extend(true,{},this);b.uri.segments.options.skip=c;return b};f=function(c){var b;b=a.extend(true,{},this);b.uri.segments.options.filter=c;return b};e=function(c){var b;b=a.extend(true,{},this);b.uri.segments.options.expand=c;return b};h=function(c){var b;b=a.extend(true,{},this);b.uri.segments.options.select=c;return b};c=function(b){var c;b=b===undefined?true:b;c=a.extend(true,{},this);c.uri.segments.options.inlinecount=b;return c};g=function(c){var b;b=a.extend(true,{},this);b.uri.segments.options.params=c;return b};i=function(b){var c,d=true,e=b;if(typeof b==="boolean")d=b;else if(a.isFunction(b))e={success:b};else if(b===undefined)d=false;c=a.extend(true,{},this);c.uri.segments.count=true;if(d)c.query(e);else return c};k=function(b){var c,d=true,e=b;if(typeof b==="boolean")d=b;else if(a.isFunction(b))e={success:b};else if(b===undefined)d=false;c=a.extend(true,{},this);c.uri.segments.value=true;if(d)c.query(e);else return c};b.uri.segments.resource=n;b.value=k;b.count=i;b.params=g;b.orderby=d;b.top=m;b.skip=l;b.filter=f;b.expand=e;b.select=h;b.links=j;b.inlinecount=c;return b};d=function(c,b,d){var a={};a.data=c.d===undefined?c:c.d;if(b!==undefined){a.version=b.getResponseHeader("DataServiceVersion").replace(";","");a.ETag=b.getResponseHeader("ETag");a.status=b.status;a.statusText=b.statusText}a.query=d;return a};b=function(c,e){var f,b,g={contentType:"application/json",dataType:"json",etag:null,type:"GET"};b=jQuery.extend({},g,c.settings,e);b.actualType=b.type==="PUT"||b.type==="DELETE"||b.type==="MERGE"?"POST":b.type;if(b.type==="GET"&&b.dataType!=="jsonp")if(c.uri.value)b.dataType="*/*";else if(c.uri.count)b.dataType="text";if(b.dataType==="jsonp")b.jsonpCallback="resultCallback";f=function(g,f,e){a.isFunction(b.success)&&b.success(d(g,e,c),f,e)};a.ajax({beforeSend:function(d){d.setRequestHeader("MaxDataServiceVersion","2.0");if(c.uri.segments.count||c.uri.segments.options.inlinecount||c.uri.segments.options.select!==undefined)d.setRequestHeader("DataServiceVersion","2.0");else d.setRequestHeader("DataServiceVersion","1.0");b.etag!==null&&d.setRequestHeader("If-Match",b.etag);(e.type==="DELETE"||e.type==="PUT"||e.type==="MERGE")&&d.setRequestHeader("X-HTTP-Method",e.type);a.isFunction(b.beforeSend)&&b.beforeSend(d)},data:b.data,dataType:b.dataType,contentType:b.contentType,password:b.password,username:b.username,timeout:b.timeout,type:b.actualType,jsonpCallback:b.jsonpCallback,processData:false,url:c.uri.toString(),success:f,complete:b.complete,error:b.error})};a.odata=f;a.odataUri=c})(jQuery)